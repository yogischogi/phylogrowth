\section{Theory}

\subsection{Population Growth}

Let us assume that we have a closed population and take a
number of genetic samples. We analyse the samples and get
different genetic lineages as a result.

The number of genetic lineages is proportional to the 
total population size.

\begin{equation}
L \sim P \label{lineages-population}
\end{equation}

\begin{tabular}{ll}
L:   & number of detected lineages\\
P:   & population size
\end{tabular}
\vspace{1em}

If we detect all male lineages, for example, the population
size would be about twice as much.

How does population size change with time? If we look after a
short period of time we may take the old population size, add
the number of births and subtract the number of deaths.

\begin{equation}
P(t+dt) = P(t) + b(t)dt - d(t)dt 
\end{equation}

\begin{tabular}{ll}
$P$: & population size\\
$b$: & number of births per second\\
$d$: & number of deaths per second\\
$t$: &time
\end{tabular}
\vspace{1em}

The probability of a mutation is the same for all newborn
babies. This means the number of newly appearing mutations
and lineages within a period of time scales with the number
of births within that period. Thus we are interested in the
number of births and rewrite the previous formula as

\begin{equation}
b(t)dt = P(t+dt) - P(t) + d(t)dt
\end{equation}

or

\begin{eqnarray}
b(t) & = & \frac{P(t+dt)- P(t)}{dt} + d(t)\\
     & = & \frac{dP(t)}{dt} + d(t) \label{births-per-second}
\end{eqnarray}

As an easy model let us assume that the number of deaths
per second is proportional to the total population size.
In this case the following equation holds:

\begin{equation}
d(t) = c_{d} P(t)
\end{equation}

\begin{tabular}{ll}
$d$:     & number of deaths per second\\
$P$:     & population size\\
$c_{d}$: & constant
\end{tabular}
\vspace{1em}

Under this assumption we can rewrite equation \ref{births-per-second}
as

\begin{equation}
b(t) = \frac{dP(t)}{dt} + c_{d} P(t)
\label{births-per-second-final}
\end{equation}

This means that the number of births per second depends on
two terms, the population growth and the population size.


\subsection{Measurement of Phylogenetic Growth}

We can not measure the number of births for every point in
history directly. We can only look at a phylogenetic tree
and examine how the number of lineages increases with time.

Let us assume that a fraction $c_l$ of all births develops
into lineages that are still on the phylogenetic tree today.
If we try to count these lineages we can count all new lineages
on the phylogenetic tree between to points in time.

\begin{equation}
g(t) = c_l \int\limits_{t-\frac{a}{2}}^{t+\frac{a}{2}} b(t) dt
\end{equation}

If we substitute $b(t)$ with equation \ref{births-per-second-final}
we get

\begin{equation}
g(t) = c_l \int\limits_{t-\frac{a}{2}}^{t+\frac{a}{2}} \frac{dP(t)}{dt} + c_{d} P(t) dt
\end{equation}

\begin{tabular}{ll}
$g$:     & growth of phylogenetic lineages between $t-\frac{a}{2}$ and $t+\frac{a}{2}$\\
$a$:     & time interval or step length used for counting\\
$c_l$:   & fraction of births that develops into long time lineages\\
$P$:     & population size\\
$c_{d}$: & fraction of the population size that dies per second
\end{tabular}
\vspace{1em}

For practical purposes we assume that the measurement time
interval $a$ is small compared to the time it takes for any
significant population changes. Then we may write the previous
equation as

\begin{equation}
g(t) \approx c_l a \left( \frac{dP(t)}{dt} + c_{d} P(t) \right) \label{phylogrowth}
\end{equation}

This means that the measured increase in phylogenetic lineages
at any given time is roughly proportional to the number of births
at that time and this depends on population size and growth.

Equation \ref{phylogrowth} is only valid for complete phylogenetic
trees. In reality we have to take into account that only a fraction
$c_t$ of the population has tested.

Furthermore the probability to detect a certain lineage depends
on it's age. If we characterize a specific historic lineage by
it's SNP mutation we will find this mutation whenever a person
belonging to the SNP subclade has tested. Thus the probability
to detect a certain SNP scales with the number of persons
carrying it. For simplicity we assume that all subclades grow
equally with population growth.

If the fraction $c_t$ of the population that has tested is
very small, we will miss most of the younger lineages. The
older ones however will be amplified by the number of their
sublineages and thus population growth.
In this case we may write:

\begin{eqnarray}
d(t) & \approx & c_t \frac{P(t_0)}{P(t)} g(t)\\
     & \approx & c_t \frac{P(t_0)}{P(t)} c_l a b(t) \\
     & \approx & c_t \frac{P(t_0)}{P(t)} c_l a \left( \frac{dP(t)}{dt} + c_{d} P(t) \right)
\end{eqnarray}

\begin{tabular}{ll}
$d$:     & detected number of new lineages between $t-\frac{a}{2}$ and $t+\frac{a}{2}$\\
$c_t$:   & fraction of the population that has tested.\\
$P$:     & population size\\
$t$:     & time\\
$t_0$:   & time of testing\\
$g$:     & growth of phylogenetic lineages between $t-\frac{a}{2}$ and $t+\frac{a}{2}$\\
$b$:     & number of births per second\\
$a$:     & time interval or step length used for counting\\
$c_l$:   & fraction of births that develops into long time lineages\\
$c_{d}$: & fraction of the population size that dies per second
\end{tabular}
\vspace{1em}











